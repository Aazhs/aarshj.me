<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0a1f">
    <title>The Digital Mathscape</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    <!-- Central Brain/Chip Icon -->
    <div id="central-icon" class="central-icon">
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="50" r="20" fill="none" stroke="url(#gradient)" stroke-width="2"/>
            <circle cx="50" cy="50" r="15" fill="url(#gradient)" opacity="0.3"/>
            <!-- Circuit lines -->
            <line x1="30" y1="50" x2="10" y2="50" stroke="url(#gradient)" stroke-width="1.5"/>
            <line x1="70" y1="50" x2="90" y2="50" stroke="url(#gradient)" stroke-width="1.5"/>
            <line x1="50" y1="30" x2="50" y2="10" stroke="url(#gradient)" stroke-width="1.5"/>
            <line x1="50" y1="70" x2="50" y2="90" stroke="url(#gradient)" stroke-width="1.5"/>
            <circle cx="10" cy="50" r="3" fill="#00ffff"/>
            <circle cx="90" cy="50" r="3" fill="#00ffff"/>
            <circle cx="50" cy="10" r="3" fill="#00ffff"/>
            <circle cx="50" cy="90" r="3" fill="#00ffff"/>
            <defs>
                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#00ffff;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#9d00ff;stop-opacity:1" />
                </linearGradient>
            </defs>
        </svg>
    </div>

    <!-- Glowing Lines -->
    <div id="grid-lines" class="grid-lines">
        <div class="line line-vertical"></div>
        <div class="line line-horizontal"></div>
    </div>

    <!-- Main Grid Container -->
    <div id="grid-container" class="grid-container">
        <!-- QR Codes Card -->
        <div class="card" data-topic="qr">
            <div class="card-content">
                <div class="card-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="35" height="35" fill="currentColor" opacity="0.8"/>
                        <rect x="55" y="10" width="35" height="35" fill="currentColor" opacity="0.8"/>
                        <rect x="10" y="55" width="35" height="35" fill="currentColor" opacity="0.8"/>
                        <rect x="20" y="20" width="15" height="15" fill="#0a0a1f"/>
                        <rect x="65" y="20" width="15" height="15" fill="#0a0a1f"/>
                        <rect x="20" y="65" width="15" height="15" fill="#0a0a1f"/>
                        <rect class="qr-scan" x="0" y="0" width="100" height="2" fill="#00ffff" opacity="0.6"/>
                    </svg>
                </div>
                <h2 class="card-title" data-text="QR Codes"></h2>
                <p class="card-description">Error correction through Reed-Solomon codes</p>
            </div>
            <div class="data-stream"></div>
        </div>

        <!-- Computers & Trigonometry Card -->
        <div class="card" data-topic="trig">
            <div class="card-content">
                <div class="card-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <rect x="20" y="30" width="60" height="40" rx="3" fill="none" stroke="currentColor" stroke-width="2"/>
                        <rect x="25" y="35" width="50" height="25" fill="currentColor" opacity="0.3"/>
                        <line x="1" y="1" x2="99" y2="1" stroke="currentColor" stroke-width="0.5" class="keyboard-line"/>
                        <circle cx="50" cy="50" r="2" fill="#00ffff" class="cpu-pulse"/>
                        <path class="sine-wave" d="M 10 50 Q 25 30, 40 50 T 70 50 T 100 50" fill="none" stroke="#9d00ff" stroke-width="1.5"/>
                    </svg>
                </div>
                <h2 class="card-title" data-text="Computers & Trigonometry"></h2>
                <p class="card-description">Taylor series approximations in CPUs</p>
            </div>
            <div class="data-stream"></div>
        </div>

        <!-- GPS & Triangulation Card -->
        <div class="card" data-topic="gps">
            <div class="card-content">
                <div class="card-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="30" fill="none" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="1" opacity="0.5"/>
                        <ellipse cx="50" cy="50" rx="30" ry="10" fill="none" stroke="currentColor" stroke-width="1" opacity="0.5"/>
                        <ellipse cx="50" cy="50" rx="10" ry="30" fill="none" stroke="currentColor" stroke-width="1" opacity="0.5"/>
                        <circle class="satellite sat-1" cx="50" cy="20" r="3" fill="#00ffff"/>
                        <circle class="satellite sat-2" cx="80" cy="50" r="3" fill="#00ffff"/>
                        <circle class="satellite sat-3" cx="50" cy="80" r="3" fill="#00ffff"/>
                        <circle cx="50" cy="50" r="4" fill="#9d00ff"/>
                    </svg>
                </div>
                <h2 class="card-title" data-text="GPS & Triangulation"></h2>
                <p class="card-description">Trilateration in 3D space</p>
            </div>
            <div class="data-stream"></div>
        </div>

        <!-- Noise Cancellation Card -->
        <div class="card" data-topic="noise">
            <div class="card-content">
                <div class="card-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <path d="M 30 35 L 30 65 L 45 55 L 45 45 Z" fill="currentColor"/>
                        <rect x="45" y="40" width="5" height="20" fill="currentColor"/>
                        <path class="sound-wave wave-1" d="M 55 50 Q 60 40, 65 50 T 75 50" fill="none" stroke="#00ffff" stroke-width="1.5" opacity="0.8"/>
                        <path class="sound-wave wave-2" d="M 55 50 Q 60 35, 65 50 T 75 50" fill="none" stroke="#00ffff" stroke-width="1.5" opacity="0.5"/>
                        <path class="sound-wave wave-3" d="M 55 50 Q 60 30, 65 50 T 75 50" fill="none" stroke="#00ffff" stroke-width="1.5" opacity="0.3"/>
                    </svg>
                </div>
                <h2 class="card-title" data-text="Noise Cancellation"></h2>
                <p class="card-description">Destructive interference & DSP</p>
            </div>
            <div class="data-stream"></div>
        </div>
    </div>

    <!-- Deep Dive Sections -->
    <div id="deepdive-qr" class="deepdive-section">
        <button class="close-btn">‚úï</button>
        <div class="deepdive-content">
            <h1>QR Codes: Error Correction Magic</h1>
            
            <div class="section">
                <h3>Interactive QR Code Generator</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    QR codes use Reed-Solomon error correction to remain readable even when damaged. 
                    Try creating your own QR code and see how much damage it can withstand!
                </p>
                
                <div id="qr-encoding" class="visualization">
                    <div class="qr-input-section">
                        <div class="input-group">
                            <label for="qr-text-input">Enter Text or URL:</label>
                            <input type="text" id="qr-text-input" class="text-input" 
                                   value="https://aarshj.me" placeholder="Type anything...">
                            <button id="generate-qr-btn" class="action-btn">üîÑ Generate QR Code</button>
                        </div>
                        
                        <div class="error-level-selector">
                            <label>Error Correction Level:</label>
                            <div class="level-buttons">
                                <button class="level-btn" data-level="L">
                                    <span class="level-name">Low</span>
                                    <span class="level-desc">~7% recovery</span>
                                </button>
                                <button class="level-btn" data-level="M">
                                    <span class="level-name">Medium</span>
                                    <span class="level-desc">~15% recovery</span>
                                </button>
                                <button class="level-btn" data-level="Q">
                                    <span class="level-name">Quartile</span>
                                    <span class="level-desc">~25% recovery</span>
                                </button>
                                <button class="level-btn active" data-level="H">
                                    <span class="level-name">High</span>
                                    <span class="level-desc">~30% recovery</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="qr-display-section">
                        <div class="qr-main-display">
                            <canvas id="qr-canvas" width="300" height="300"></canvas>
                            <div class="qr-info">
                                <span id="qr-size-info">Size: --</span>
                                <span id="qr-capacity-info">Capacity: --</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Error Correction Simulator</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Click on the QR code below to damage individual cells, or use the slider to add random damage. 
                    Watch Reed-Solomon algorithm work its magic to recover the original data!
                </p>
                
                <div id="qr-correction" class="visualization">
                    <div class="damage-controls">
                        <div class="damage-slider-group">
                            <label for="damage-slider">
                                <span>Damage Amount:</span>
                                <span id="damage-percentage">0%</span>
                            </label>
                            <input type="range" id="damage-slider" min="0" max="40" value="0" step="1">
                            <div class="damage-buttons">
                                <button id="apply-damage-btn" class="action-btn">üí• Apply Random Damage</button>
                                <button id="clear-damage-btn" class="action-btn">üîÑ Clear Damage</button>
                            </div>
                        </div>
                        
                        <div class="damage-stats">
                            <div class="stat-item">
                                <span class="stat-label">Damaged Cells:</span>
                                <span id="damaged-count" class="stat-value">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Recovery Status:</span>
                                <span id="recovery-status" class="stat-value">Perfect</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="correction-container">
                        <div class="qr-pair">
                            <div class="qr-display interactive">
                                <h4>Interactive Damage (Click to toggle cells)</h4>
                                <canvas id="qr-damaged" width="300" height="300"></canvas>
                                <p class="hint">üí° Click on cells to damage/repair them</p>
                            </div>
                            
                            <div class="correction-arrow">
                                <div class="arrow-body">
                                    <div class="reed-solomon-badge">
                                        <span class="badge-title">Reed-Solomon</span>
                                        <span class="badge-subtitle">Error Correction</span>
                                    </div>
                                </div>
                                <button id="correct-btn" class="action-btn correct-btn">
                                    ‚ú® Attempt Recovery
                                </button>
                            </div>
                            
                            <div class="qr-display">
                                <h4>Recovered QR Code</h4>
                                <canvas id="qr-corrected" width="300" height="300"></canvas>
                                <p id="scan-status" class="scan-status">Awaiting correction...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-box qr-info-box">
                        <h4>üßÆ How Reed-Solomon Works:</h4>
                        <ul>
                            <li><strong>Polynomial Encoding:</strong> Data is encoded as coefficients of a polynomial</li>
                            <li><strong>Redundancy:</strong> Extra error correction codewords are added (up to 30% of data)</li>
                            <li><strong>Syndrome Calculation:</strong> Detects which cells are corrupted</li>
                            <li><strong>Error Locator:</strong> Finds the exact positions of errors</li>
                            <li><strong>Correction:</strong> Uses polynomial math to calculate correct values</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="deepdive-trig" class="deepdive-section">
        <button class="close-btn">‚úï</button>
        <div class="deepdive-content">
            <h1>Computers & Trigonometry</h1>
            
            <div class="section">
                <h3>Taylor Series Approximation of sin(x)</h3>
                <div id="taylor-viz" class="visualization">
                    <canvas id="taylor-canvas" width="800" height="400"></canvas>
                    <div class="controls">
                        <label for="terms-slider">Number of Terms: <span id="terms-value">1</span></label>
                        <input type="range" id="terms-slider" min="1" max="9" value="1" step="1">
                    </div>
                    <div id="taylor-formula" class="formula-display"></div>
                </div>
            </div>

            <div class="section">
                <h3>Inside the CPU</h3>
                <div id="cpu-viz" class="visualization">
                    <div class="cpu-container">
                        <div class="cpu-input">
                            <div class="binary-stream" id="binary-input"></div>
                            <p>Input (Binary)</p>
                        </div>
                        <div class="cpu-chip">
                            <div class="chip-label">ALU</div>
                            <div class="chip-glow"></div>
                            <div class="operations">
                                <div class="op">+ Addition</div>
                                <div class="op">√ó Multiplication</div>
                                <div class="op">√∑ Division</div>
                            </div>
                        </div>
                        <div class="cpu-output">
                            <div class="result-display" id="cpu-result">sin(x) ‚âà <span id="result-value">0</span></div>
                            <p>Output</p>
                        </div>
                    </div>
                    <div class="error-table">
                        <h4>Approximation Error</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Terms</th>
                                    <th>Max Error</th>
                                </tr>
                            </thead>
                            <tbody id="error-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="deepdive-gps" class="deepdive-section">
        <button class="close-btn">‚úï</button>
        <div class="deepdive-content">
            <h1>GPS & Trilateration</h1>
            
            <div class="section">
                <h3>Interactive Trilateration Simulator</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    GPS uses trilateration (not triangulation!) with at least 4 satellites. Each satellite provides a distance measurement, 
                    creating a sphere of possible locations. The intersection of these spheres pinpoints your exact position.
                </p>
                
                <div id="gps-viz" class="visualization">
                    <div class="gps-controls-top">
                        <div class="satellite-info">
                            <h4>Satellites</h4>
                            <div id="satellite-distances" class="distance-readouts">
                                <div class="sat-readout" data-sat="0">
                                    <span class="sat-indicator" style="background: #ff0080;"></span>
                                    <span class="sat-label">SAT-1:</span>
                                    <span class="sat-distance">--</span>
                                </div>
                                <div class="sat-readout" data-sat="1">
                                    <span class="sat-indicator" style="background: #00ff80;"></span>
                                    <span class="sat-label">SAT-2:</span>
                                    <span class="sat-distance">--</span>
                                </div>
                                <div class="sat-readout" data-sat="2">
                                    <span class="sat-indicator" style="background: #ffaa00;"></span>
                                    <span class="sat-label">SAT-3:</span>
                                    <span class="sat-distance">--</span>
                                </div>
                                <div class="sat-readout" data-sat="3">
                                    <span class="sat-indicator" style="background: #00ffff;"></span>
                                    <span class="sat-label">SAT-4:</span>
                                    <span class="sat-distance">--</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="position-info">
                            <h4>Your Position</h4>
                            <div class="coords">
                                <span id="position-status">Drag receiver to see distances</span>
                            </div>
                        </div>
                    </div>
                    
                    <canvas id="globe-canvas" width="900" height="650"></canvas>
                    
                    <div class="controls">
                        <button id="show-spheres" class="action-btn">üåê Show Distance Spheres</button>
                        <button id="auto-locate" class="action-btn">üìç Auto-Locate</button>
                        <button id="randomize-satellites" class="action-btn">üõ∞Ô∏è Randomize Satellites</button>
                        <button id="reset-trilateration" class="action-btn">üîÑ Reset</button>
                    </div>
                    
                    <div class="info-box gps-info">
                        <h4>üí° How to Use:</h4>
                        <ul>
                            <li><strong>Drag the white receiver</strong> (on Earth) to change your position</li>
                            <li><strong>Drag satellites</strong> to see how their positions affect signal coverage</li>
                            <li><strong>Show Spheres</strong> to visualize the distance to each satellite</li>
                            <li><strong>Auto-Locate</strong> to see trilateration solve for your position automatically</li>
                            <li><strong>Need 4 satellites:</strong> 3 for position (x,y,z) + 1 for clock synchronization</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="deepdive-noise" class="deepdive-section">
        <button class="close-btn">‚úï</button>
        <div class="deepdive-content">
            <h1>Noise Cancellation</h1>
            
            <div class="section">
                <h3>Wave Physics Laboratory</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Active Noise Cancellation works by generating an anti-noise wave that is 180¬∞ out of phase with the incoming sound. 
                    When these waves combine through superposition, they cancel each other out.
                </p>
                
                <div id="noise-viz" class="visualization">
                    <div class="wave-graphs">
                        <!-- Original Wave Canvas -->
                        <div class="graph-container">
                            <h4>1. Original Noise Wave (Ambient Sound)</h4>
                            <canvas id="noise-original" width="800" height="180"></canvas>
                        </div>
                        
                        <!-- Anti-Noise Wave Canvas -->
                        <div class="graph-container anti-noise">
                            <h4>2. Anti-Noise Wave (Generated by ANC System)</h4>
                            <canvas id="noise-inverted" width="800" height="180"></canvas>
                            <div class="phase-control">
                                <label for="phase-shift">
                                    <span class="control-label">Phase Shift:</span>
                                    <span id="phase-value">180¬∞</span>
                                </label>
                                <input type="range" id="phase-shift" min="0" max="360" value="180" step="1">
                                <div class="phase-markers">
                                    <span>0¬∞</span>
                                    <span>90¬∞</span>
                                    <span>180¬∞</span>
                                    <span>270¬∞</span>
                                    <span>360¬∞</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Resultant Wave Canvas -->
                        <div class="graph-container result">
                            <h4>3. Resultant Wave (Superposition)</h4>
                            <canvas id="noise-result" width="800" height="180"></canvas>
                            <div class="result-info">
                                <span id="cancellation-level">Perfect Cancellation: 100%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button id="play-noise" class="action-btn">‚ñ∂ Play Animation</button>
                        <button id="stop-noise" class="action-btn">‚è∏ Pause</button>
                        <button id="reset-phase" class="action-btn">üîÑ Reset Phase</button>
                    </div>
                    
                    <div class="info-box">
                        <h4>üí° How It Works:</h4>
                        <ul>
                            <li><strong>Original Wave:</strong> The blue wave represents ambient noise (like engine hum or background chatter)</li>
                            <li><strong>Anti-Noise Wave:</strong> The purple wave is generated by the ANC microphone and DSP, inverted 180¬∞</li>
                            <li><strong>Phase Shift Control:</strong> Adjust the slider to see what happens when the anti-noise is not perfectly aligned</li>
                            <li><strong>Perfect Cancellation:</strong> At 180¬∞ phase shift, the waves completely cancel each other out!</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
